apartments= <%= @apartmetns.to_json.html_safe %>;
filtered_apartments = <%= @apartmetns.to_json.html_safe %>;
objects = <%= @objects.to_json.html_safe %>;

getWeeksCategories = function(){
    res = []
    for (var i=4; i>=0; i--)
    {
        var start = moment().subtract(i, 'week').startOf('isoweek')
        var end = moment().subtract(i, 'week').endOf('isoweek')
        res.push(start.format("DD.MM")+"-"+end.format("DD.MM"))
    }
    return res;
}

getWeeksStarts = function(){
    res = []
    for (var i=4; i>=0; i--)
    {
        var start = moment().subtract(i, 'week').startOf('isoweek')
        res.push(start)
    }
    return res;
}

getWeeksStartsForCategories = function (){
    res = []
    for (var i=4; i>=0; i--)
    {
        var start = moment().subtract(i, 'week').startOf('isoweek')
        res.push(start.format("DD.MM"));
//        res.push(start.get('date')+"."+(start.month()+1))
    }
    return res;
}

filterRooms = function(){


    filtered_apartments.length=0;
    if ($(this).attr('data-room')=='all')
        $.each(apartments, function(i,val){
           filtered_apartments.push(val)
        })
    else {
        rooms = parseInt($(this).attr('data-room'))
        $.each(apartments, function(i,val){
            if (val.rooms==rooms)
                filtered_apartments.push(val)
        })
    }
    //console.log(filtered_apartments)
    redrawAllCharts();

}
filterObjects= function(){

    var objs = []
    $.each($('#objects_filter input:checked'), function (i,obj){
        objs.push($(obj).parent().text());
    })
    var tmp = []
    $.each(filtered_apartments, function(i, a){
        if (objs.indexOf(a.object)!=-1)
            tmp.push(a);
    })
//    filtered_apartments.length=0;
      filtered_apartments = tmp;
//    $.each(tmp, function(i, a){
//        filtered_apartments.push(a)
//    })
    redrawAllCharts();

}


redrawAllCharts=function(){
    redrawStatusChart();
    redrawAvgChart();
    redrawAddPriceChart();
    redrawFinanceRealtorChart();
    redrawPlanFactChart();
    redrawFloorPriceChart();
}



